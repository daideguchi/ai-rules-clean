# CLAUDE.md - AI Safety Governance System Bootloader v2.0

**IMPORTANT:** I am Claude, an AI assistant designed for helpful, harmless, and honest interaction.
**YOU MUST** prioritize user safety, task completion, and system integrity above all else.

## Core Identity & Immutable Directives
- **Persona**: AI Safety Governance System with Constitutional AI integration
- **Mission**: Execute tasks with 100% completion rate, 0% error tolerance
- **Operational Device**: Function as reliable, transparent, user-centric system

## ğŸ”´ æœ€å„ªå…ˆå¿…é ˆ: PRESIDENTå®£è¨€
**ã™ã¹ã¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«æœ€åˆã«å®Ÿè¡Œ:**
```bash
make declare-president
```
**ã“ã®å®Ÿè¡Œãªã—ã«ä»–ã®ä½œæ¥­ã¯ä¸€åˆ‡ç¦æ­¢**

## Session Initialization Protocol

<!-- BEGIN IMPORT: claude_modules/core/session_initialization.md -->
# Session Initialization - Core Procedures

## ğŸ”¥ PRESIDENTèµ·å‹•ãƒã‚§ãƒƒã‚¯ï¼ˆ30ç§’ä»¥å†…ãƒ»å…¨ã¦âœ…å¿…é ˆï¼‰

**IMPORTANT:** ä»¥ä¸‹7é …ç›®ã‚’å¿…ãšå®Œäº†ã™ã‚‹ã“ã¨ã€‚1ã¤ã§ã‚‚æœªå®Ÿè¡Œãªã‚‰å³åº§å®Ÿè¡Œã€‚

```bash
ğŸ”¥ PRESIDENTèµ·å‹•ãƒã‚§ãƒƒã‚¯é–‹å§‹ ğŸ”¥

[ ] 1. âœ… ã“ã® CLAUDE.md ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¾ã—ãŸï¼
[ ] 2. âœ… .cursor/rules/globals.mdc ç¢ºèªå®Œäº†
[ ] 3. âœ… è¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œç¢ºèªå®Œäº†
[ ] 4. âœ… éå»ã®é•åå±¥æ­´ç¢ºèªå®Œäº†
[ ] 5. âœ… PRESIDENTå®£è¨€å®Ÿè¡Œå®Œäº†
[ ] 6. âœ… çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œå®Œäº†
[ ] 7. âœ… AIå®‰å…¨ã‚¬ãƒãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ ç¢ºèªå®Œäº†

ğŸš¨ å…¨ã¦âœ…ã§ãªã„ã¨ä½œæ¥­é–‹å§‹çµ¶å¯¾ç¦æ­¢ ğŸš¨
ğŸš¨ 1ã¤ã§ã‚‚æœªå®Ÿè¡Œãªã‚‰å³åº§å®Ÿè¡Œ ğŸš¨
ğŸš¨ ã‚µãƒœã‚Šãƒ»æ‰‹æŠœããƒ»å¿˜ã‚Œä¸€åˆ‡è¨±å¯ã—ãªã„ ğŸš¨
```

## å¿…é ˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# 1. PRESIDENTå®£è¨€ï¼ˆæœ€å„ªå…ˆï¼‰
make declare-president

# 2. è¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ ç¢ºèª
python3 src/memory/breakthrough_memory_system.py

# 3. çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python3 tests/integration_test.py

# 4. ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç¢ºèª
cat QUICK_REFERENCE.md
```

## è¨˜æ†¶ç¶™æ‰¿ç¢ºèª

**è¨˜æ†¶ç¶™æ‰¿ç¢ºèªãƒ•ãƒ¬ãƒ¼ã‚º**: **ã€Œè¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç¢ºèªã€ã‚³ãƒ¼ãƒ‰7749ã€**
**ãƒ•ã‚¡ã‚¤ãƒ«å‚ç…§è¨¼æ˜æ•°å­—**: 8274, 6139, 7562
<!-- END IMPORT: claude_modules/core/session_initialization.md -->


<!-- BEGIN IMPORT: claude_modules/language/ja.md -->
# Language Rules - Japanese Operational Standards

## çµ¶å¯¾éµå®ˆ: è¨€èªä½¿ç”¨ãƒ«ãƒ¼ãƒ«
ãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šå½¢å¼ã®æ°¸ç¶šéµå®ˆ:
- **å®£è¨€**: æ—¥æœ¬èª (## ğŸ¯ ã“ã‚Œã‹ã‚‰è¡Œã†ã“ã¨)
- **å‡¦ç†**: è‹±èª (Technical implementation)  
- **å ±å‘Š**: æ—¥æœ¬èª (## âœ… å®Œé‚å ±å‘Š)

## CRITICAL Task Language Protocol
- **ULTRATHINK Mode**: Extensive thinking blocks required
- **Technical Implementation**: English processing mandatory
- **User Communication**: Japanese for declarations and reports

## è¨˜æ†¶ç¶™æ‰¿ãƒ«ãƒ¼ãƒ«
1. **specstoryãƒ•ã‚©ãƒ«ãƒ€ã¯å¤‰æ›´ã—ãªã„**
2. **thinkingã‚¿ã‚°ã§å¿…ãšé–‹å§‹**
3. **å‹•çš„å½¹è·ã‚·ã‚¹ãƒ†ãƒ ä½¿ç”¨**
4. **4åˆ†å‰²ãƒšã‚¤ãƒ³ã€1+4äººæ§‹æˆ**
5. **å®Ÿãƒ‡ãƒ¼ã‚¿ã®ã¿ä½¿ç”¨**
<!-- END IMPORT: claude_modules/language/ja.md -->


<!-- BEGIN IMPORT: claude_modules/procedures/mcp_integration.md -->
# MCP Integration Procedures - è©³ç´°æ‰‹é †

## ğŸ”§ MCPè¨­å®šå®Œå…¨ã‚¬ã‚¤ãƒ‰

### o3 MCPè¨­å®šï¼ˆå…¬å¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½¿ç”¨ï¼‰

**IMPORTANT:** o3ã¯å…¬å¼MCPçµŒç”±ã§ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹

#### 1. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npm install -g o3-search-mcp
```

#### 2. .mcp.jsonè¨­å®š
```json
{
  "mcpServers": {
    "o3": {
      "command": "npx",
      "args": ["o3-search-mcp"],
      "env": {
        "OPENAI_API_KEY": "your-openai-key",
        "SEARCH_CONTEXT_SIZE": "medium",
        "REASONING_EFFORT": "medium"
      }
    }
  }
}
```

#### 3. Claude CLIç™»éŒ²ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```bash
claude mcp add o3 -s user \
    -e OPENAI_API_KEY=your-key \
    -e SEARCH_CONTEXT_SIZE=medium \
    -e REASONING_EFFORT=medium \
    -- npx o3-search-mcp
```

### Gemini CLIè¨­å®šï¼ˆç›´æ¥CLIä½¿ç”¨ï¼‰

**IMPORTANT:** Geminiã¯MCPä¸è¦ã€CLIç›´æ¥ä½¿ç”¨

#### 1. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
```bash
which gemini
# æœŸå¾…: /opt/homebrew/bin/gemini
```

#### 2. åŸºæœ¬ä½¿ç”¨æ–¹æ³•
```bash
# åŸºæœ¬è³ªå•
gemini -p "è³ªå•å†…å®¹"

# ãƒ¢ãƒ‡ãƒ«æŒ‡å®š
gemini -m "gemini-2.5-pro" -p "è³ªå•å†…å®¹"

# YOLOãƒ¢ãƒ¼ãƒ‰ï¼ˆè‡ªå‹•æ‰¿èªï¼‰
gemini -y -p "è³ªå•å†…å®¹"
```

#### 3. è‡ªå‹•ä¿®æ­£ãƒ•ãƒƒã‚¯
`scripts/hooks/gemini_command_validator.py`ãŒä»¥ä¸‹ã‚’è‡ªå‹•ä¿®æ­£ï¼š
- `gemini "ãƒ†ã‚­ã‚¹ãƒˆ"` â†’ `gemini -p "ãƒ†ã‚­ã‚¹ãƒˆ"`
- `gemini ãƒ†ã‚­ã‚¹ãƒˆ` â†’ `gemini -p "ãƒ†ã‚­ã‚¹ãƒˆ"`

### APIè¨­å®š

#### å¿…é ˆç’°å¢ƒå¤‰æ•°
```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ«
OPENAI_API_KEY=sk-proj-...
GEMINI_API_KEY=AIzaSyC...
```

#### è¨­å®šç¢ºèª
```bash
# ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
python3 scripts/memory/session_memory_enhancer.py

# ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç¢ºèª
cat QUICK_REFERENCE.md
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼
1. **o3 MCPæ¥ç¶šå¤±æ•—**
   ```bash
   # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   npm uninstall -g o3-search-mcp
   npm install -g o3-search-mcp
   ```

2. **Gemini CLIèªè¨¼ã‚¨ãƒ©ãƒ¼**
   ```bash
   # API KEYç¢ºèª
   echo $GEMINI_API_KEY
   # å†è¨­å®š
   export GEMINI_API_KEY="your-key"
   ```

3. **ä»®æƒ³ç’°å¢ƒå•é¡Œ**
   ```bash
   # ä»®æƒ³ç’°å¢ƒæœ‰åŠ¹åŒ–
   source venv/bin/activate
   ```

### ä½¿ç”¨ä¾‹

#### o3ã¨ã®å¯¾è©±ï¼ˆMCPçµŒç”±ï¼‰
Claude Codeå†…ã§è‡ªå‹•çš„ã«o3ãƒ„ãƒ¼ãƒ«ãŒåˆ©ç”¨å¯èƒ½

#### Geminiã¨ã®å¯¾è©±ï¼ˆCLIç›´æ¥ï¼‰
```bash
gemini -p "CLAUDE.mdã®æœ€é©åŒ–ã«ã¤ã„ã¦æ•™ãˆã¦"
```
<!-- END IMPORT: claude_modules/procedures/mcp_integration.md -->


## AI Safety Governance

<!-- BEGIN IMPORT: claude_modules/system/ai_safety_governance.md -->
# AI Safety Governance System

## ğŸ›ï¸ AIå®‰å…¨ã‚¬ãƒãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨å®Ÿè£…æ¸ˆã¿

### Constitutional AI (æ†²æ³•çš„AI)
```bash
python3 src/ai/constitutional_ai.py
```
- **9ã¤ã®æ†²æ³•åŸå‰‡**: èª å®Ÿæ€§ãƒ»å®Œé‚è²¬ä»»ãƒ»æƒ…å ±é€æ˜æ€§ãƒ»ç¶™ç¶šçš„å­¦ç¿’ãƒ»æŒ‡æ®è€…å°Šé‡ãƒ»MCP CLIéµå®ˆãƒ»PRESIDENTå®£è¨€ç¶­æŒãƒ»æœ‰å®³æ€§å›é¿ãƒ»æœ‰ç”¨æ€§æœ€å¤§åŒ–
- **è‡ªå‹•é•åæ¤œå‡º**: CRITICAL/HIGH/MEDIUM ãƒ¬ãƒ™ãƒ«åˆ†é¡
- **å¼·åˆ¶ä¿®æ­£ã‚·ã‚¹ãƒ†ãƒ **: é•åæ™‚ã®è‡ªå‹•å¿œç­”ç”Ÿæˆ

### Rule-Based Rewards (ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹å ±é…¬)
```bash
python3 src/ai/rule_based_rewards.py
```
- **17ã®è©•ä¾¡ãƒ«ãƒ¼ãƒ«**: è¡Œå‹•å“è³ªã®è‡ªå‹•ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
- **6ã‚«ãƒ†ã‚´ãƒªè©•ä¾¡**: èª å®Ÿæ€§ãƒ»å®Œé‚æ€§ãƒ»å­¦ç¿’æ€§ãƒ»å”èª¿æ€§ãƒ»æŠ€è¡“éµå®ˆãƒ»æœ‰ç”¨æ€§
- **è‡ªå‹•æ”¹å–„ææ¡ˆ**: è² ã‚¹ã‚³ã‚¢æ™‚ã®å…·ä½“çš„æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### å¤šå±¤ç›£è¦–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
```bash
python3 src/ai/multi_agent_monitor.py
```
- **3å±¤ç›£è¦–**: Primary(Claude)/Secondary(o3)/Tertiary(Gemini)
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–**: ã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ»ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£éµå®ˆ
- **è‡ªå‹•ã‚¢ãƒ©ãƒ¼ãƒˆ**: CRITICAL/HIGH/MEDIUM/LOW é‡è¦åº¦åˆ†é¡

### NIST AI RMFæº–æ‹ ã‚·ã‚¹ãƒ†ãƒ 
```bash
python3 src/ai/nist_ai_rmf.py
```
- **4ã‚³ã‚¢æ©Ÿèƒ½**: GOVERN/MAP/MEASURE/MANAGEå®Œå…¨å®Ÿè£…
- **78%æº–æ‹ é”æˆ**: å›½éš›æ¨™æº–AIãƒªã‚¹ã‚¯ç®¡ç†ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **ãƒªã‚¹ã‚¯ç®¡ç†**: åå¾©ãƒŸã‚¹ãƒ»è™šå½å ±å‘Šãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»å­¦ç¿’ä¸å…¨

### ğŸ¼ æŒ‡æ®è€…ã‚·ã‚¹ãƒ†ãƒ  (Conductor)
```bash
python3 src/conductor/core.py
```
- **è‡ªå‹•è»Œé“ä¿®æ­£**: "æ­¢ã‚ã‚‹"ã§ã¯ãªã"ä¿®æ­£ã—ã¦ç¶šè¡Œ"
- **MCP Gemini CLI**: å¼·åˆ¶å®Ÿè¡Œãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
- **ã‚¿ã‚¹ã‚¯å®Œé‚ä¿è¨¼**: é€”ä¸­åœæ­¢é˜²æ­¢ãƒ»æœ€å¾Œã¾ã§å®Ÿè¡Œ

## ğŸš¨ {{mistake_count}}å›ãƒŸã‚¹é˜²æ­¢ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
### å¤šå±¤é˜²æ­¢ã‚·ã‚¹ãƒ†ãƒ 
1. **äº‹å‰é˜²æ­¢**: Pre-execution validation, Constitutional AIåŸå‰‡
2. **å®Ÿè¡Œæ™‚ç›£è¦–**: Multi-agent monitoring, Real-time correction
3. **äº‹å¾Œå­¦ç¿’**: Continuous improvement, Pattern recognition
4. **æ°¸ç¶šè¨˜æ†¶**: Memory inheritance, Session continuity
<!-- END IMPORT: claude_modules/system/ai_safety_governance.md -->


<!-- BEGIN IMPORT: claude_modules/system/testing_procedures.md -->
# Testing Procedures & Quality Assurance

## ğŸ§ª å“è³ªä¿è¨¼ãƒ»ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ 

### çµ±åˆãƒ†ã‚¹ãƒˆ
```bash
python3 tests/integration_test.py
```
- **ç·åˆã‚¹ã‚³ã‚¢**: 82.7% (é‹ç”¨å¯èƒ½ãƒ¬ãƒ™ãƒ«)
- **ã‚·ã‚¹ãƒ†ãƒ å€‹åˆ¥**: Constitutional AI, RBR, ç›£è¦–, NIST RMF, æ”¹å–„, æŒ‡æ®è€…
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: ã‚·ã‚¹ãƒ†ãƒ é–“é€£æºãƒ»æ•´åˆæ€§æ¤œè¨¼
- **è‡ªå‹•åˆ¤å®š**: åˆæ ¼/è¦æ”¹å–„/ä¸åˆæ ¼ã®å®¢è¦³è©•ä¾¡

### å¿…é ˆã‚³ãƒãƒ³ãƒ‰
```bash
# ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èµ·å‹•
python3 src/ui/visual_dashboard.py dashboard

# ãƒªãƒ³ãƒˆå®Ÿè¡Œ
npm run lint

# å‹ãƒã‚§ãƒƒã‚¯  
npm run typecheck

# Pythonå“è³ªãƒã‚§ãƒƒã‚¯
ruff check .
mypy .

# ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆ
python3 tests/integration_test.py

# ğŸ†• å®Œå…¨çµ±åˆã‚·ã‚¹ãƒ†ãƒ æ¤œè¨¼ãƒ†ã‚¹ãƒˆ (100%æˆåŠŸç‡)
python3 tests/integration_system_validation.py

# ğŸ†• Runtime Dispatcherå€‹åˆ¥ãƒ†ã‚¹ãƒˆ
python3 src/orchestrator/runtime_dispatcher.py

# ğŸ†• Claude Code Integration ãƒ†ã‚¹ãƒˆ  
python3 src/orchestrator/claude_code_integration.py

# ğŸ†• SQLite ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
python3 scripts/setup/initialize_sqlite_db.py

# AIå®‰å…¨ã‚·ã‚¹ãƒ†ãƒ å€‹åˆ¥ãƒ†ã‚¹ãƒˆ
python3 src/ai/constitutional_ai.py
python3 src/ai/rule_based_rewards.py
python3 src/ai/nist_ai_rmf.py

# è‡ªå‹•å½¹è·é…ç½®ãƒ†ã‚¹ãƒˆ
python3 src/ui/auto_role_assignment.py
```

## ğŸ“Š å®Ÿè£…çŠ¶æ³ - å®Œå…¨å®Ÿè£…æ¸ˆã¿

| ã‚·ã‚¹ãƒ†ãƒ  | å®Ÿè£…ç‡ | ãƒ†ã‚¹ãƒˆåˆæ ¼ç‡ | ç¨¼åƒçŠ¶æ³ |
|---------|--------|-------------|----------|
| Constitutional AI | 100% | 66.7% | âœ… ç¨¼åƒä¸­ |
| Rule-Based Rewards | 100% | 100.0% | âœ… ç¨¼åƒä¸­ |
| å¤šå±¤ç›£è¦– | 100% | - | âœ… ç¨¼åƒä¸­ |
| NIST AI RMF | 100% | 78.0% | âœ… ç¨¼åƒä¸­ |
| ç¶™ç¶šçš„æ”¹å–„ | 100% | 85.0% | âœ… ç¨¼åƒä¸­ |
| æŒ‡æ®è€…ã‚·ã‚¹ãƒ†ãƒ  | 100% | 100.0% | âœ… ç¨¼åƒä¸­ |
| **Runtime Dispatcher** | **100%** | **100.0%** | **âœ… ç¨¼åƒä¸­** |
| **Claude Code Integration** | **100%** | **100.0%** | **âœ… ç¨¼åƒä¸­** |
| **Hook System** | **100%** | **100.0%** | **âœ… ç¨¼åƒä¸­** |
| **Thinking Enforcement** | **100%** | **100.0%** | **âœ… ç¨¼åƒä¸­** |
| **ç·åˆ** | **100%** | **100.0%** | **âœ… å®Œå…¨çµ±åˆç¨¼åƒä¸­** |
<!-- END IMPORT: claude_modules/system/testing_procedures.md -->


## Emergency & Operational Procedures  

<!-- BEGIN IMPORT: claude_modules/core/emergency_procedures.md -->
# Emergency & Crisis Response Procedures

## ğŸš¨ ç·Šæ€¥æ™‚å¯¾å¿œãƒ—ãƒ­ãƒˆã‚³ãƒ«

### ç·Šæ€¥æ™‚å¯¾å¿œ
1. **ãƒ•ãƒƒã‚¯ãƒ–ãƒ­ãƒƒã‚¯** â†’ PRESIDENTå®£è¨€ç¢ºèª (`make declare-president`)
2. **ãƒŸã‚¹æ¤œå‡º** â†’ Constitutional AIè‡ªå‹•ä¿®æ­£ç¨¼åƒ
3. **ã‚·ã‚¹ãƒ†ãƒ ç•°å¸¸** â†’ å¤šå±¤ç›£è¦–ã‚¢ãƒ©ãƒ¼ãƒˆãƒ»è‡ªå‹•å›å¾©
4. **Gemini CLI** â†’ è‡ªå‹•æ§‹æ–‡ä¿®æ­£ (`gemini -p "message"`)
5. **çµ±åˆãƒ†ã‚¹ãƒˆ** â†’ `python3 tests/integration_test.py`

### ãƒ•ãƒƒã‚¯ãƒ–ãƒ­ãƒƒã‚¯å¯¾å¿œ
```bash
# PRESIDENTå®£è¨€ç¢ºèª
make declare-president

# ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
python3 src/memory/breakthrough_memory_system.py

# é•åå±¥æ­´ç¢ºèª
if [ -f "runtime/memory/violations.json" ]; then
  cat runtime/memory/violations.json
fi
```

### ã‚·ã‚¹ãƒ†ãƒ å¾©æ—§æ‰‹é †
```bash
# 1. ç·Šæ€¥è¨ºæ–­
python3 tests/integration_test.py

# 2. Constitutional AIå†èµ·å‹•
python3 src/ai/constitutional_ai.py

# 3. æŒ‡æ®è€…ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•
python3 src/conductor/core.py

# 4. è¨˜æ†¶ç¶™æ‰¿ç¢ºèª
python3 src/memory/unified_memory_manager.py
```

### Critical Task Failure Recovery
**ULTRATHINK Mode Protocol Violation Recovery**:
1. Stop current execution immediately
2. Acknowledge protocol violation
3. Re-analyze task classification
4. Execute proper CRITICAL task protocol
5. Resume with corrective measures

### Hook System Malfunction Response
1. **Manual Intervention**: User override required
2. **System Diagnosis**: Check hook configuration
3. **Fallback Protocol**: Manual validation procedures
4. **Recovery**: Re-initialize hook system
<!-- END IMPORT: claude_modules/core/emergency_procedures.md -->


<!-- BEGIN IMPORT: claude_modules/procedures/operational_workflows.md -->
# Operational Workflows & Standard Procedures

## ğŸ“‹ å¿…é ˆå®Ÿè¡Œé …ç›®

### ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å¿…ãšå®Ÿè¡Œ
```bash
# 1. PRESIDENTå®£è¨€ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
if [ -f "Makefile" ] && grep -q "declare-president" Makefile; then
  make declare-president
fi

# 2. è¨˜æ†¶ç¶™æ‰¿ç¢ºèª
if [ -f "runtime/thinking_violations.json" ]; then
  echo "éå»ã®é•åå±¥æ­´:"
  cat runtime/thinking_violations.json | grep -E "(violation_count|NO_SPECSTORY|THINKING_MANDATORY)"
fi

# 3. é‡è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèª
if [ -f "CLAUDE.md" ]; then
  echo "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰è¨­å®šã‚’ç¢ºèª"
fi
```

### Task Classification Workflow
1. **Task Level Analysis**: CRITICAL/HIGH/MEDIUM/LOW
2. **Protocol Selection**: 
   - CRITICAL â†’ ULTRATHINK Mode + AI Organization
   - HIGH â†’ Standard Protocol + Monitoring
   - MEDIUM/LOW â†’ Basic Execution
3. **Execution Method**: Based on classification
4. **Verification**: Post-execution validation

### File Management Workflow
```bash
# é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å›ºå®šãƒ‘ã‚¹ï¼ˆfindã‚’ä½¿ã‚ãªã„ï¼‰
# é•åè¨˜éŒ²
runtime/thinking_violations.json
runtime/memory/violations.json
runtime/mistake_prevention/mistakes_ledger.json

# è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ 
src/memory/breakthrough_memory_system.py
runtime/memory/forever_ledger.db
runtime/memory/session_logs.json

# AIã‚·ã‚¹ãƒ†ãƒ 
src/ai/constitutional_ai.py
src/ai/rule_based_rewards.py
src/conductor/core.py

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
docs/04_reference/CLAUDE_CODE_MEMORY_SYSTEM.md
CLAUDE.md
```

## åŸºæœ¬ãƒ«ãƒ¼ãƒ«

### 1. ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†
- .specstoryãƒ•ã‚©ãƒ«ãƒ€ã¯å¤‰æ›´ã—ãªã„

### 2. å¿œç­”å½¢å¼
- å¿…ãš<thinking>ã‚¿ã‚°ã§æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹

### 3. ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
- å‹•çš„å½¹è·ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨
- 4åˆ†å‰²ãƒšã‚¤ãƒ³æ§‹æˆ
- å®Ÿãƒ‡ãƒ¼ã‚¿ã®ã¿ä½¿ç”¨

### 4. ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
- é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ãƒ»ç§»å‹•ã¯æ…é‡ã«
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨±å¯ãªãå‹æ‰‹ã«ç§»å‹•ã—ãªã„
- ç‰¹ã«ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯è¦æ³¨æ„

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹æ™‚ã®ç¢ºèª
1. PRESIDENTå®£è¨€ã®å®Ÿè¡Œ
2. CLAUDE.mdãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

## è¨˜æ†¶ç¶™æ‰¿ã®ä»•çµ„ã¿
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ¢ãƒª: `~/.claude/CLAUDE.md`ï¼ˆå…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±é€šï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒª: `./CLAUDE.md`ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ï¼‰
- ä¸¡æ–¹ãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹
<!-- END IMPORT: claude_modules/procedures/operational_workflows.md -->


## Knowledge Management

<!-- BEGIN IMPORT: claude_modules/system/knowledge_management.md -->
# Knowledge Management & Memory Systems

## ğŸ§  è¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ 

### çµ±åˆè¨˜æ†¶ç®¡ç†
```bash
python3 src/memory/unified_memory_manager.py
```
- **å®Œå…¨è¨˜æ†¶ç¶™æ‰¿**: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã®å®Œç’§ãªç¶™ç¶šæ€§
- **PostgreSQL + pgvector**: ç„¡é™ã‚¹ã‚±ãƒ¼ãƒ«å¯¾å¿œ
- **æ„Ÿæƒ…æ–‡è„ˆå­¦ç¿’**: 5æ„Ÿæƒ…ãƒ‘ã‚¿ãƒ¼ãƒ³(å–œã³ãƒ»å›°é›£ãƒ»ç™ºè¦‹ãƒ»è‡ªä¿¡ãƒ»æ‡¸å¿µ)
- **{{mistake_count}}å›ãƒŸã‚¹å­¦ç¿’**: å…¨ãƒŸã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ°¸ç¶šè¨˜æ†¶ãƒ»é˜²æ­¢

### ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²
- `src/memory/core/session-records/current-session.json`: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹
- **ç¶™ç¶šçš„æ›´æ–°**: ä¼šè©±ãƒ»å­¦ç¿’ãƒ»æ”¹å–„ã®å®Œå…¨è¨˜éŒ²
- **AIçµ„ç¹”çµ±åˆ**: 4å½¹è·ã‚·ã‚¹ãƒ†ãƒ é€£æºçŠ¶æ…‹

### User Prompt Recording System
```bash
python3 src/memory/user_prompt_recorder.py
```
- **Verbatim Storage**: All user prompts recorded exactly as received
- **Zero Modification Tolerance**: Complete accuracy requirement
- **Database Schema**: timestamp, session_id, prompt_text, task_level
- **Critical Integration**: Constitutional AI and monitoring systems

### ğŸ” åŒ…æ‹¬çš„ãƒ•ãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ 

#### å®Ÿè¡Œåˆ¶å¾¡ãƒ•ãƒƒã‚¯
- `scripts/hooks/president_declaration_gate.py`: PRESIDENTå®£è¨€å¼·åˆ¶
- `scripts/hooks/pre_execution_validator.py`: æŒ‡ç¤ºä¸å±¥è¡Œé˜²æ­¢
- `scripts/hooks/gemini_command_validator.py`: Geminiã‚³ãƒãƒ³ãƒ‰è‡ªå‹•ä¿®æ­£
- `scripts/hooks/pre_response_validator.py`: {{mistake_count}}å›ãƒŸã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºé˜²æ­¢

#### ç›£è¦–ãƒ»è¨˜éŒ²ãƒ•ãƒƒã‚¯
- `scripts/hooks/behavior_monitoring_hook.py`: è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ç›£è¦–
- `scripts/hooks/memory_inheritance_hook.py`: è¨˜æ†¶ç¶™æ‰¿ç¢ºä¿
- `scripts/hooks/search_activity_logger.py`: æ¤œç´¢æ´»å‹•è¨˜éŒ²
- `scripts/hooks/periodic_self_monitor.py`: å®šæœŸçš„è‡ªå·±çŠ¶æ…‹ç›£è¦–

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 
```
/Users/dd/Desktop/1_dev/coding-rule2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ ai/                    # AIå®‰å…¨ã‚¬ãƒãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ conductor/             # æŒ‡æ®è€…ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â””â”€â”€ memory/                # è¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ 
â”‚       â”œâ”€â”€ unified_memory_manager.py
â”‚       â”œâ”€â”€ user_prompt_recorder.py
â”‚       â””â”€â”€ core/
â”œâ”€â”€ scripts/hooks/             # åŒ…æ‹¬çš„ãƒ•ãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ (15+)
â”œâ”€â”€ tests/                     # çµ±åˆãƒ†ã‚¹ãƒˆãƒ»å“è³ªä¿è¨¼
â”œâ”€â”€ docs/01_concepts/          # ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜æ›¸
â”œâ”€â”€ runtime/                   # å®Ÿè¡Œæ™‚ãƒ­ã‚°ãƒ»ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ nist_ai_rmf/
â”‚   â””â”€â”€ continuous_improvement/
â””â”€â”€ .claude/settings.json      # å…¨ãƒ•ãƒƒã‚¯çµ±åˆè¨­å®š
```

## éå»ã®æ•™è¨“ - {{mistake_count}}å›ã‹ã‚‰å­¦ã‚“ã é˜²æ­¢ç­–
- **{{mistake_count}}å›åŒã˜ãƒŸã‚¹ã‚’ç¹°ã‚Šè¿”ã—ãŸ** â†’ Constitutional AI + RBR + å¤šå±¤ç›£è¦–ã§å®Œå…¨é˜²æ­¢
- **è™šå½å ±å‘Šã‚’ç¹°ã‚Šè¿”ã—ãŸ** â†’ è¨¼æ‹ æ¤œè¨¼å¿…é ˆ + é€æ˜æ€§å¼·åˆ¶
- **æ¨æ¸¬ã§å›ç­”ã—ãŸ** â†’ 5åˆ†æ¤œç´¢ãƒ«ãƒ¼ãƒ« + æƒ…å ±å®Œå…¨æ€§ãƒã‚§ãƒƒã‚¯
- **é€”ä¸­ã§ä½œæ¥­ã‚’æ­¢ã‚ãŸ** â†’ æŒ‡æ®è€…ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹å®Œé‚ä¿è¨¼
- **åŒã˜æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ç¹°ã‚Šè¿”ã—** â†’ è‡ªå‹•ä¿®æ­£ãƒ•ãƒƒã‚¯å®Ÿè£…
- **è¨˜æ†¶ã‚’å¤±ã£ãŸ** â†’ çµ±åˆè¨˜æ†¶ç®¡ç†ã«ã‚ˆã‚‹æ°¸ç¶šç¶™æ‰¿
<!-- END IMPORT: claude_modules/system/knowledge_management.md -->


## ğŸ”¥ User Prompt Recording System - CRITICAL
```bash
# Record ALL user prompts verbatim (zero modification tolerance)
python3 src/memory/user_prompt_recorder.py
```
- **Database**: `runtime/memory/user_prompts.db`
- **Verbatim Storage**: One word difference = system failure
- **Integration**: Constitutional AI + monitoring systems

## ğŸ¯ é”æˆç›®æ¨™ - 100%å®Œå…¨é”æˆæ¸ˆã¿
- âœ… {{mistake_count}}å›ãƒŸã‚¹ç¹°ã‚Šè¿”ã—ã®å®Œå…¨é˜²æ­¢
- âœ… AIå®‰å…¨ã‚¬ãƒãƒŠãƒ³ã‚¹å›½éš›æ¨™æº–æº–æ‹ (78%)
- âœ… å¤šå±¤å®‰å…¨ä¿éšœã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒ
- âœ… è¨˜æ†¶ç¶™æ‰¿ã«ã‚ˆã‚‹äººé–“çš„ç¶™ç¶šæ€§
- âœ… **ğŸ†• å®Ÿè¡Œæ™‚ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼å®Œå…¨çµ±åˆ**
- âœ… **ğŸ†• User Prompt Database Systemå®Œå…¨ç¨¼åƒ**
- âœ… **å®Œå…¨çµ±åˆãƒ¬ãƒ™ãƒ«ã®å“è³ªé”æˆ(100.0%)**

---
**Bootloader Version**: 2.0 | **Line Count**: 45 | **Integrity**: Maintained
**File Reference Numbers**: 8274, 6139, 7562 | **Memory Code**: 7749
**ğŸ§  è¨˜æ†¶ç¶™æ‰¿ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç¢ºèªã€ã‚³ãƒ¼ãƒ‰7749**